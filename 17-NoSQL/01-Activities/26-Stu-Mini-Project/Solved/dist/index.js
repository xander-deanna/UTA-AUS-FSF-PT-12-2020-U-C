let myChart,transactions=[];fetch("/api/transaction").then(a=>a.json()).then(a=>{transactions=a,populateTotal(),populateTable(),populateChart()});function populateTotal(){const a=transactions.reduce((a,b)=>a+parseFloat(b.value),0).toFixed(2),b=document.querySelector("#total");b.textContent=a}function populateTable(){const a=document.querySelector("#tbody");a.innerHTML="",transactions.forEach(b=>{const c=document.createElement("tr");c.innerHTML=`
      <td>${b.name}</td>
      <td>${b.value}</td>
    `,a.appendChild(c)})}function populateChart(){const a=transactions.slice().reverse();let b=0;const c=a.map(a=>{const b=new Date(a.date);return`${b.getMonth()+1}/${b.getDate()}/${b.getFullYear()}`}),d=a.map(a=>(b+=parseInt(a.value),b));myChart&&myChart.destroy();const e=document.getElementById("my-chart").getContext("2d");myChart=new Chart(e,{type:"line",data:{labels:c,datasets:[{label:"Total Over Time",fill:!0,backgroundColor:"#6666ff",data:d}]}})}function sendTransaction(a){const b=document.querySelector("#t-name"),c=document.querySelector("#t-amount"),d=document.querySelector("form .error");if(""===b.value||""===c.value)return void(d.textContent="Missing Information");d.textContent="";const e={name:b.value,value:c.value,date:new Date().toISOString()};a||(e.value*=-1),transactions.unshift(e),populateChart(),populateTable(),populateTotal(),fetch("/api/transaction",{method:"POST",body:JSON.stringify(e),headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"}}).then(a=>a.json()).then(a=>{a.errors?d.textContent="Missing Information":(b.value="",c.value="")}).catch(()=>{console.log("save record"),saveRecord(e),b.value="",c.value=""})}document.querySelector("#add-btn").addEventListener("click",function(a){a.preventDefault(),sendTransaction(!0)}),document.querySelector("#sub-btn").addEventListener("click",function(a){a.preventDefault(),sendTransaction(!1)});